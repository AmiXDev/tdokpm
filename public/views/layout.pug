doctype html
html
	head
		title= `${title} | ${h.siteName}`
		link(rel='stylesheet', href='/dist/style.css')
		link(rel='stylesheet', href='/dist/swiper.min.css')
		link(rel="shortcut icon" type="image/png" href="/images/icons/doughnut.png")
		meta(name="viewport" content="width=device-width, initial-scale=1")
	body
	block navbarTop
		nav.navbar-top-container.fixed-header
			button(type=button).toggle-button.btn-toggle-menu.btn-hamburger.js-slideout-toggle
				.toggle-view
					.toggles
						.toggle-icon
			button#go-back(type=button, onClick=`window.history.back()`)
				.go-back-icon
					.inner-go-back-icon
	block slideOutMenu
		nav.menu-slideout#menu.slideout-menu.slideout-menu-right
			ul.menu-slideout-unordered-list
				.logo-slideout
					img(src=h.siteLogo alt="آقای گوگل")
					.spelling-groupe
						.englishMrgoogle Mr-Google
						.persianMrgoogle آقای گوگل
				each item in h.menu
					li.menu-slidout-items
						a.menu-slideout-link(href=item.slug, class=(currentPath.startsWith(item.slug) ? 'navbar-menu-active' : ''))
								!= h.icon(item.icon)
								span #{item.title}
			ul.social-slideout-unordered-list
				each item in h.socialmediasIcon
					li.socials-items
						a.social-items-link(href=item.slug alt=item.alt)
							!= h.icon(item.icon)
			.copyright-section
				span طراحی و توسعه با 
				!= h.copyright
				span توسط AmiX
	main#panel
		block messages
			if locals.flashes
				.flash-messages
				- const categories = Object.keys(locals.flashes)
						each category in categories
							each message in flashes[category]
								.flash(class=`flash--${category}`)
									p.flash__text!= message
									button.flash__remove(onClick="this.parentElement.remove()") &times;
		.offScreen
		block content
			p content
		block footer
			p footer
		block live-chat
			.msg_box(style="left: 0px")
				.msg_head
					img(src=h.liveSupport)
					.typing-indicator
						span
						span
						span
				.contentArea(style="display: none")
					.msg_header-info
							<div class="chat-online-supporter">
								span پشتیبانی آنلاین مستر گوگل
							</div>
							button.minimize-chat-support
								img(src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iaXNvLTg4NTktMSI/Pg0KPCEtLSBHZW5lcmF0b3I6IEFkb2JlIElsbHVzdHJhdG9yIDE5LjAuMCwgU1ZHIEV4cG9ydCBQbHVnLUluIC4gU1ZHIFZlcnNpb246IDYuMDAgQnVpbGQgMCkgIC0tPg0KPHN2ZyB2ZXJzaW9uPSIxLjEiIGlkPSJMYXllcl8xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBmaWxsPSIjRkZGIiB4PSIwcHgiIHk9IjBweCINCgkgdmlld0JveD0iMCAwIDQ5MS45OTYgNDkxLjk5NiIgc3R5bGU9ImVuYWJsZS1iYWNrZ3JvdW5kOm5ldyAwIDAgNDkxLjk5NiA0OTEuOTk2OyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8Zz4NCgk8Zz4NCgkJPHBhdGggZD0iTTQ4NC4xMzIsMTI0Ljk4NmwtMTYuMTE2LTE2LjIyOGMtNS4wNzItNS4wNjgtMTEuODItNy44Ni0xOS4wMzItNy44NmMtNy4yMDgsMC0xMy45NjQsMi43OTItMTkuMDM2LDcuODZsLTE4My44NCwxODMuODQ4DQoJCQlMNjIuMDU2LDEwOC41NTRjLTUuMDY0LTUuMDY4LTExLjgyLTcuODU2LTE5LjAyOC03Ljg1NnMtMTMuOTY4LDIuNzg4LTE5LjAzNiw3Ljg1NmwtMTYuMTIsMTYuMTI4DQoJCQljLTEwLjQ5NiwxMC40ODgtMTAuNDk2LDI3LjU3MiwwLDM4LjA2bDIxOS4xMzYsMjE5LjkyNGM1LjA2NCw1LjA2NCwxMS44MTIsOC42MzIsMTkuMDg0LDguNjMyaDAuMDg0DQoJCQljNy4yMTIsMCwxMy45Ni0zLjU3MiwxOS4wMjQtOC42MzJsMjE4LjkzMi0yMTkuMzI4YzUuMDcyLTUuMDY0LDcuODU2LTEyLjAxNiw3Ljg2NC0xOS4yMjQNCgkJCUM0OTEuOTk2LDEzNi45MDIsNDg5LjIwNCwxMzAuMDQ2LDQ4NC4xMzIsMTI0Ljk4NnoiLz4NCgk8L2c+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8Zz4NCjwvZz4NCjxnPg0KPC9nPg0KPGc+DQo8L2c+DQo8L3N2Zz4NCg==")
					.formArea
						.title  لطفا  اطلاعات زیر را وارد کنید تا در صورت قطع ارتباط با شما تماس برقرار کنیم.
						form.inputFields
							each item in h.onlineChat
								.inputContainer.group-field
									label.form-label
										input.input-field(class=`${item.class}`, type=item.type, placeholder=" ", required)
										span.label #{item.label}
										!= h.icon(item.icon)
							input.submitBtn.btn(type="submit", value="گفتگو با پشتیبان")
						.copyright-section
							span طراحی و توسعه با
							!= h.copyright
							span توسط AmiX
					.chatArea(style="display: none")
						.messages
							.msg_push_old
							.msg_push_new
						.typing
						input.inputMessage(rows="1", placeholder="پیام خود را وارد کنید....")

	block navbar-bottom
		nav.navbar-bottom-container
			ul.navbar-bottom-unordered-list
				if user
					each item in h.navbarBottomItemsForUser
						li.navbar-bottom-items.user-logged-in
							a.navbar-bottom-link(href=item.slug, class=(currentPath.startsWith(item.slug) ? 'navbar-bottom-active' : ''))
								!= h.icon(item.icon)
								span #{item.title}
				else
					each item in h.navbarBottomItems
						li.navbar-bottom-items
							a.navbar-bottom-link(href=item.slug, class=(currentPath.startsWith(item.slug) ? 'navbar-bottom-active' : ''))
									!= h.icon(item.icon)
									span #{item.title}
	block scripts
		script(src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.2.0/socket.io.js")
		script(src="/dist/App.bundle.js")
		script(src="https://unpkg.com/swiper/swiper-bundle.min.js")
		//-script(src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js")
		script(src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@0.7.0")
		script.
			
			//- (function($){
			//- 	moment.locale('fa'); 
			//- 	$(".createdDate").text();
			//- 	$(".createdDate").removeClass('hidden');
			//- })(jQuery);
				//const response = '#{resultArrayForDate}';
				//var regex = /[^,]+/g;
				//const string = /[^,]+/g.exec(response)
				//var regex = response.replace(/[^,]+/g, "'$&'");
		
			function ChartJsPreview() {

			var ctx = document.getElementById('chart-preview').getContext('2d');

			if (!ctx) {
				return false;
			}

			const gradient = ctx.createLinearGradient(0, 0, 0, 400);
			gradient.addColorStop(0, 'rgba(84,145,237,0.5)');
			gradient.addColorStop(0, 'rgba(84,145,237,0.5)');
			gradient.addColorStop(0.5, 'rgba(84,145,237,0.01)');
			gradient.addColorStop(0.75, 'rgba(84,145,237,0)');
			gradient.addColorStop(1, 'rgba(84,145,237,0)');
			Chart.defaults.global.title.fontFamily = 'Vazir'
			ctx.fillStyle = gradient;
			let draw = Chart.controllers.line.prototype.draw;
			Chart.controllers.line = Chart.controllers.line.extend({
			draw: function() {
				draw.apply(this, arguments);
				let ctx = this.chart.chart.ctx;
				let _stroke = ctx.stroke;
				ctx.stroke = function() {
					ctx.save();
					ctx.shadowColor = '#0000001c';
					ctx.shadowBlur = 0;
					ctx.shadowOffsetX = 0;
					ctx.shadowOffsetY = 4;
					_stroke.apply(this, arguments)
					ctx.restore();
				}
			}
			});
			function argMax(array) {
				return array.map((x, i) => [x, i]).reduce((r, a) => (a[0] > r[0] ? a : r))[1];
			}

			function argMin(array) {
				return array.map((x, i) => [x, i]).reduce((r, a) => (a[0] < r[0] ? a : r))[1];
			}

			const data = [#{resultArrayForDollar}].slice(-24);

			var color = data.map(x => '#FFF');
			
			color[argMax(data)] = '#f14336';

			color[argMin(data)] = '#28b446';
			
			Chart.defaults.global.defaultFontColor = 'white';

			const myChart = new Chart(ctx, {
				type: 'line',
				data: {
					labels: [#{resultArrayForDate}].slice(-5),
					datasets: [
						{
							data: [#{resultArrayForDollar}].slice(-5),
							backgroundColor : gradient,
							borderColor: 'white',
							pointColor : 'transparent',
							pointBorderColor: "transparent",
							//- pointBorderWidth: 5,
							//- borderWidth: 3,
							pointBackgroundColor: color,
							lineTension: 0,
							datalabels: {
								textAlign: 'center',
								align: 'top',
								anchor: 'end',
								offset: 5
							}
						}
					]
				},
				options: {
					title: {
						display: true,
						text: 'نمودار لحظه ای دلار حواله',
						padding	: 30
					},
					tooltips: {
						enabled: false
					},
					layout: {
						padding: {
							left: 20,
							right: 30,
							top: -15,
							bottom: 7
						}
					},
					maintainAspectRatio: false,
					datasetStrokeWidth : 3,
					legend: {
						display: false
					},
					scales: {
						yAxes: [{
							position: 'left',
							gridLines: {
								display: false,
								color: '#ffffff20',
							},
							ticks: {
								display: false,
								min: 25000,
								max: 28000,
								stepSize: 500,
								mirror: false,
								drawTicks: false
							},
							scaleLabel: {
								display: false,
								labelString: "قیمت ارز (دلار)",
								fontFamily:	'Vazir'
							}
						}],
						xAxes: [{
							type: 'time',
							//- distribution: 'series',
							time: {
								unit: 'hour',
								stepSize: 1,
								displayFormats: {
									hour: 'HH:mm',
								}
							},
							//- parser: function (utcMoment) {
							//- 	return utcMoment.utcOffset('+0430');
							//- },
							gridLines: {
								display: true,
								color: '#ffffff20',
								zeroLineColor: '#ffffff20'
							},
							ticks: {
								display: true
							},
							scaleLabel: {
								display: true,
								labelString: "ساعات (۲۴ ساعت گذشته)",
								fontFamily:	'Vazir'
							}
						}]
					},
					animation:{
						onComplete : function(){
							var ctx = this.chart.ctx;
							ctx.textAlign = "center";
							ctx.textBaseline = "center";
						}
					}
				}
			});
			}
